{% extends "base.twig" %}

{% block title %}{% if currentTicket %}Edit Ticket{% else %}New Ticket{% endif %} - Ticket Management{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <header class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-8">
                    <h1 class="text-2xl font-bold text-gray-900">TicketApp</h1>
                    <nav class="hidden md:flex gap-6">
                        <a href="index.php?page=dashboard" class="text-gray-600 hover:text-gray-900">Dashboard</a>
                        <a href="index.php?page=tickets" class="text-gray-600 hover:text-gray-900">Tickets</a>
                    </nav>
                </div>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-600">{{ user.name }}</span>
                    <form method="POST" action="index.php?page=logout" class="inline">
                        <button type="submit" class="text-sm text-gray-600 hover:text-gray-900">
                            Logout
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-6">
            <a href="index.php?page=tickets" class="text-sm text-gray-600 hover:text-gray-900">
                ‚Üê Back to tickets
            </a>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">
                {% if currentTicket %}Edit Ticket{% else %}Create New Ticket{% endif %}
            </h2>
            
            <form method="POST" action="index.php?page=ticket-form">
                {% if currentTicket %}
                    <input type="hidden" name="id" value="{{ currentTicket.id }}" />
                    <input type="hidden" name="created_at" value="{{ currentTicket.created_at }}" />
                {% endif %}
                
                <div class="mb-6">
                    <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                        Title *
                    </label>
                    <input
                        type="text"
                        id="title"
                        name="title"
                        required
                        value="{% if currentTicket %}{{ currentTicket.title }}{% endif %}"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Enter ticket title"
                    />
                </div>
                
                <div class="mb-6">
                    <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                        Description *
                    </label>
                    <textarea
                        id="description"
                        name="description"
                        required
                        rows="4"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="Describe the issue or request"
                    >{% if currentTicket %}{{ currentTicket.description }}{% endif %}</textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div>
                        <label for="status" class="block text-sm font-medium text-gray-700 mb-2">
                            Status
                        </label>
                        <select
                            id="status"
                            name="status"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="open" {% if currentTicket and currentTicket.status == 'open' %}selected{% endif %}>Open</option>
                            <option value="in_progress" {% if currentTicket and currentTicket.status == 'in_progress' %}selected{% endif %}>In Progress</option>
                            <option value="closed" {% if currentTicket and currentTicket.status == 'closed' %}selected{% endif %}>Closed</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="priority" class="block text-sm font-medium text-gray-700 mb-2">
                            Priority
                        </label>
                        <select
                            id="priority"
                            name="priority"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="low" {% if currentTicket and currentTicket.priority == 'low' %}selected{% endif %}>Low</option>
                            <option value="medium" {% if currentTicket and currentTicket.priority == 'medium' %}selected{% endif %}>Medium</option>
                            <option value="high" {% if currentTicket and currentTicket.priority == 'high' %}selected{% endif %}>High</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <button
                        type="submit"
                        class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium"
                    >
                        {% if currentTicket %}Update Ticket{% else %}Create Ticket{% endif %}
                    </button>
                    <a
                        href="index.php?page=tickets"
                        class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium"
                    >
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    </main>
</div>
{% endblock %}
